import{H as f,d as B,r as V,c as N,C as O,I as u,e as i,o as $,f as j,g as t,w as s,k as p,t as E,h as d,i as H,A as k}from"./index-39dd0681.js";const R=()=>f.get("/admin/acl/permission"),T=r=>r.id?f.put("/admin/acl/permission/update",r):f.post("/admin/acl/permission/save",r),w=r=>f.delete("/admin/acl/permission/remove/"+r),D={class:"dialog-footer"},S=B({__name:"index",setup(r){let v=V([]),n=V(!1),a=N({code:"",level:0,name:"",pid:0});O(()=>{_()});const _=async()=>{await R().then(l=>{l.code===200?v.value=l.data:u.error("获取权限列表失败")}).catch(l=>{console.log(l)})},C=async l=>{Object.assign(a,{id:0,code:"",level:0,name:"",pid:0}),n.value=!0,a.level=l.level+1,a.pid=l.id},P=async()=>{n.value=!1,await T(a).then(l=>{l.code===200?(console.log(l.data),u({type:"success",message:a.id?"修改权限成功":"添加权限成功"}),_()):u({type:"success",message:a.id?"修改权限失败":"添加权限失败"})}).catch(l=>{console.log(l)})},x=l=>{n.value=!0,Object.assign(a,l)},A=async l=>{await w(l.id).then(e=>{e.code===200?(u({type:"success",message:"删除成功！"}),_()):u({type:"error",message:"删除失败！"})})};return(l,e)=>{const c=i("el-table-column"),m=i("el-button"),q=i("el-table"),b=i("el-input"),g=i("el-form-item"),M=i("el-form"),U=i("el-dialog");return $(),j("div",null,[t(q,{data:d(v),"row-key":"id",border:"",style:{width:"100%","margin-bottom":"20px"}},{default:s(()=>[t(c,{label:"名称",prop:"name"}),t(c,{label:"权限值",prop:"code"}),t(c,{label:"修改时间",prop:"createTime"}),t(c,{label:"操作"},{default:s(({row:o})=>[t(m,{type:"primary",onClick:y=>C(o)},{default:s(()=>[p(E(o.level==3?"添加功能":"添加菜单"),1)]),_:2},1032,["onClick"]),t(m,{type:"primary",disabled:o.level==1,onClick:y=>x(o)},{default:s(()=>e[4]||(e[4]=[p(" 编辑 ")])),_:2,__:[4]},1032,["disabled","onClick"]),t(m,{type:"primary",disabled:o.level==1,onClick:y=>A(o)},{default:s(()=>e[5]||(e[5]=[p(" 删除 ")])),_:2,__:[5]},1032,["disabled","onClick"])]),_:1})]),_:1},8,["data"]),t(U,{modelValue:d(n),"onUpdate:modelValue":e[3]||(e[3]=o=>k(n)?n.value=o:n=o),title:d(a).id?"编辑菜单":"添加菜单"},{default:s(()=>[t(M,null,{default:s(()=>[t(g,{label:"名称"},{default:s(()=>[t(b,{placeholder:"请输入名称：",modelValue:d(a).name,"onUpdate:modelValue":e[0]||(e[0]=o=>d(a).name=o)},null,8,["modelValue"])]),_:1}),t(g,{label:"权限"},{default:s(()=>[t(b,{placeholder:"请输入权限值：",modelValue:d(a).code,"onUpdate:modelValue":e[1]||(e[1]=o=>d(a).code=o)},null,8,["modelValue"])]),_:1})]),_:1})]),footer:s(()=>[H("div",D,[t(m,{onClick:e[2]||(e[2]=o=>k(n)?n.value=!1:n=!1)},{default:s(()=>e[6]||(e[6]=[p("取消")])),_:1,__:[6]}),t(m,{type:"primary",onClick:P},{default:s(()=>e[7]||(e[7]=[p(" 确认 ")])),_:1,__:[7]})])]),_:1},8,["modelValue","title"])])}}});export{S as default};
